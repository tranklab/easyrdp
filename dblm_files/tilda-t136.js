function t_onFuncLoadVideo(t){"function"==typeof $.fn.videoBG?t():setTimeout(function e(){if("function"!=typeof $.fn.videoBG){if("complete"===document.readyState&&"function"!=typeof $.fn.videoBG)throw new Error("$.fn.videoBG is undefined");setTimeout(e,100)}else t()})}!function(i){function e(){this.setScrollCb(),this.itemHeight=screen.availHeight;this.itemTransitionTop=.25*this.itemHeight,this.activeItemIndex=null,this.windowHeight=document.documentElement.clientHeight||window.innerHeight||screen.availHeight,this.topOffsetShift=-150,i(window).resize(jQuery.proxy(this.recalculateAllSequencesOffsets,this)),this._resizeInterval=setInterval(jQuery.proxy(this.scrollCb,this),500)}window.processVideo=function(e){mp4Src=i(e).attr("data-content-video-url-mp4"),webmSrc=i(e).attr("data-content-video-url-webm"),i(e).css("background-color","transparent"),i(e).css("background-image","");var t={mp4:mp4Src,webm:webmSrc,preload:"none",autoplay:!1,loop:!0,scale:!0,zIndex:0,width:"100%"};t_onFuncLoadVideo(function(){vid=i(e).videoBG(t),videoLoadProcessor.registerNewVideo(vid,{isNeedStop:!1})})},e.prototype.defaultConfig={orientation:"vertical",speedFactor:1,automated:!1},e.prototype.sequenceObjects=[],e.prototype.recalculateAllSequencesOffsets=function(){this._resizeTimeout&&clearTimeout(this._resizeTimeout),this._resizeInterval&&clearInterval(this._resizeInterval),this._resizeTimeout=setTimeout(jQuery.proxy(function(){this.scrollCb(),this._resizeInterval=setInterval(jQuery.proxy(this.scrollCb,this),500)},this),10)},e.prototype.registerNewBlock=function(t){if(!(t instanceof HTMLElement))throw new Error("Wrong node type in registerNewBlock");for(var e=0,o=this.sequenceObjects.length;e<o;e++)if(this.sequenceObjects[e].sequenceBlock===t)return!1;var r=t.querySelector('[data-hook="sequence-holder"]'),s=0,i=this.getAbsoluteTopOffset(r),n=function(){var e=Array.prototype.slice.call(t.querySelectorAll('[data-hook="sequence-item"]'),0),n=[];return e.forEach(jQuery.proxy(function(e,t,o){var r=this.getItemHeight(e),i=e.querySelector('[data-hook="item-background"]');e.style.height=r+"px",i.style.height=this.itemHeight+"px",t<o.length-1&&(s+=r),n.push({node:e,height:r,topOffset:this.getAbsoluteTopOffset(e.querySelector(".txt-holder"))-(t==o.length-1?0:this.topOffsetShift),backgroundHolder:i})},this)),n}.call(this),n=(this.itemHeight,{sequenceBlock:t,sequenceHolder:r,sequenceHolderTopOffset:i,sequenceHeight:s,items:n,started:!1,prevBackgroundColor:""});return this.sequenceObjects.push(n),this.scrollCb(),!0},e.prototype.getItemHeight=function(e){var t=e.querySelector("[data-hook='item-text']");e.querySelector("[data-hook='item-background']");st=e.style;e=parseFloat(getComputedStyle(t).top);return t.style.top=e+"px",Math.max(t.clientHeight+e,this.itemHeight)},e.prototype.fixTextBlocksPosition=function(e){txtBlocks=Array.prototype.slice.call(e.querySelectorAll('[data-hook="item-text"]'),0),txtBlocks.forEach(function(e,t,o){e.parentNode.querySelector("[data-hook='item-background']").style.top="-"+e.clientHeight+"px"})},e.prototype.unergisterBlock=function(e){for(var t=0,o=this.sequenceObjects.length,r=null;t<o;t++)if(this.sequenceObjects[t].sequenceBlock===e){r=t;break}return null!==r&&(this.sequenceObjects.splice(r,1),!0)},e.prototype.getAbsoluteTopOffset=function(e){var t=e.offsetTop;for(e=e.offsetParent;null!=e;)t+=e.offsetTop,e=e.offsetParent;return t},e.prototype.processSequence=function(e){0==e.started&&(e.prevBackgroundColor=document.body.style.backgroundColor,document.body.style.backgroundColor="rgb(0, 0, 0)",e.started=!0);e.sequenceBlock,e.sequenceHolder;for(var t,o,r,i,n=e.items,s=null,c=0,l=n.length;c<l;c++)if((t=n[c].node).querySelector(".txt-holder"),(i=t.getBoundingClientRect()).top<this.itemTransitionTop&&i.bottom<i.height+this.itemTransitionTop&&i.bottom>this.itemTransitionTop){s=c;break}if(null!=s){1<(r=i.top/this.itemTransitionTop)?r=1:r<0&&(r=0);for(c=0,l=n.length;c<l;c++)t=n[c].node,"fixed"!=(o=n[c].backgroundHolder.style).position&&(o.position="fixed"),c==s?(o.opacity=1-r,t.querySelector(".txt-holder").style.opacity=1-r):c==s-1?(o.opacity=r,t.querySelector(".txt-holder").style.opacity=r):(o.opacity=0,t.querySelector(".txt-holder").style.opacity=0)}},e.prototype.stopSequence=function(e){0!=e.started&&(e.items.forEach(function(e,t,o){e.backgroundHolder.style.position="relative",e.backgroundHolder.style.display="block",e.backgroundHolder.style.opacity=1}),document.body.style.backgroundColor=e.prevBackgroundColor,e.started=!1)},e.prototype.scrollCb=function(){i(window).scrollTop();for(var e,t=0,o=this.sequenceObjects.length;t<o;t++){var r=(e=this.sequenceObjects[t]).sequenceHolder.getBoundingClientRect();r.top<0&&0<r.bottom&&r.bottom>r.height-e.sequenceHeight-100?this.processSequence(e):this.stopSequence(e)}},e.prototype.setScrollCb=function(){this._scrollCb=jQuery.proxy(this.scrollCb,this),i(window).bind("scroll",t_throttle(this._scrollCb,200))},window.sequenceController=new e}(jQuery);